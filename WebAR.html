<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>WebAR Menu with Pinch Zoom</title>
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://cdn.rawgit.com/jeromeetienne/AR.js/1.7.2/aframe/build/aframe-ar.min.js"></script>
</head>
<body style="margin: 0; overflow: hidden;">

<a-scene embedded arjs="sourceType: webcam; detectionMode: mono_and_matrix; matrixCodeType: 3x3;">
    
    <!-- Scalable Content Container -->
    <a-marker type="pattern" url="https://harshIsekai.github.io/WebAR-Markers/menu.patt">
        <a-entity id="scalable-content" scale="0.8 0.8 0.8">
            <!-- Menu Content Here -->
            <a-image src="menu.jpg" position="0 0.5 0" width="1.5" height="1"></a-image>
            <!-- Add other menu items -->
        </a-entity>
    </a-marker>

    <!-- Camera Setup -->
    <a-entity camera></a-entity>

</a-scene>

<script>
// Pinch-to-Zoom Variables
let initialDistance = null;
let currentScale = 0.8;

// Touch Start Handler
document.addEventListener('touchstart', (e) => {
    if (e.touches.length === 2) {
        initialDistance = Math.hypot(
            e.touches[0].clientX - e.touches[1].clientX,
            e.touches[0].clientY - e.touches[1].clientY
        );
    }
});

// Touch Move Handler
document.addEventListener('touchmove', (e) => {
    if (e.touches.length === 2) {
        e.preventDefault();
        
        // Calculate current distance between fingers
        const currentDistance = Math.hypot(
            e.touches[0].clientX - e.touches[1].clientX,
            e.touches[0].clientY - e.touches[1].clientY
        );

        if (initialDistance !== null) {
            // Calculate scale factor
            let scaleFactor = currentDistance / initialDistance;
            
            // Apply scale limits (0.5x to 2x)
            const newScale = Math.min(Math.max(currentScale * scaleFactor, 0.5), 2);
            
            // Update scale
            const scalableContent = document.getElementById('scalable-content');
            scalableContent.setAttribute('scale', {
                x: newScale,
                y: newScale,
                z: newScale
            });
        }
    }
});

// Touch End Handler
document.addEventListener('touchend', () => {
    // Update current scale value
    const scalableContent = document.getElementById('scalable-content');
    currentScale = parseFloat(scalableContent.getAttribute('scale').x);
    initialDistance = null;
});
</script>

<style>
/* Disable default touch behaviors */
body {
    touch-action: none;
    -webkit-touch-callout: none;
    -webkit-user-select: none;
    user-select: none;
}
</style>

</body>
</html>
